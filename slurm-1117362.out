Using device: cpu
/export/fs06/psingh54/ActiveRubric-Internal/outputs/data/initial_train.json
/export/fs06/psingh54/ActiveRubric-Internal/outputs/data/validation.json
/export/fs06/psingh54/ActiveRubric-Internal/outputs/data/test.json
/export/fs06/psingh54/ActiveRubric-Internal/outputs/data/active_pool.json
/export/fs06/psingh54/ActiveRubric-Internal/outputs/data/original_initial_train.json
/export/fs06/psingh54/ActiveRubric-Internal/outputs/data/original_validation.json
/export/fs06/psingh54/ActiveRubric-Internal/outputs/data/original_test.json
/export/fs06/psingh54/ActiveRubric-Internal/outputs/data/original_active_pool.json
Loaded datasets: Train=0, Val=360, Test=240, Active Pool=600

=== Running Random-All Experiment ===
Initial validation metrics: {'rmse': 1.002773930432755, 'mae': 0.7444444444444445, 'pearson': 0.6270296428642088, 'spearman': 0.6418109732679096, 'kendall': 0.5621685467007835, 'accuracy': 0.37222222222222223, 'avg_expected_loss': 1.5684840659300485}
=== Cycle 1/7 ===
Epoch 1/3, Loss: 21.8939
Epoch 2/3, Loss: 20.5331
Epoch 3/3, Loss: 19.4557
Training metrics: {'losses': [21.893879890441895, 20.533128929138183, 19.455655670166017], 'avg_loss': 20.627554829915365, 'examples_trained': 80, 'examples_revisited': 80}
Cycle 1 metrics: {'rmse': 1.0788368221788172, 'mae': 0.7861111111111111, 'pearson': 0.4303234941056857, 'spearman': 0.4368868358404515, 'kendall': 0.39840134552957335, 'accuracy': 0.3861111111111111, 'avg_expected_loss': 1.5346948643525442}
=== Cycle 2/7 ===
Resampled validation set with 145 examples
Epoch 1/3, Loss: 18.1103
Epoch 2/3, Loss: 16.1767
Epoch 3/3, Loss: 14.3482
Training metrics: {'losses': [18.110261344909667, 16.17666416168213, 14.348245239257812], 'avg_loss': 16.211723581949872, 'examples_trained': 80, 'examples_revisited': 80}
Cycle 2 metrics: {'rmse': 1.299867367239363, 'mae': 1.0, 'pearson': 0.4341703803735346, 'spearman': 0.43896560902641946, 'kendall': 0.36179604213123334, 'accuracy': 0.30344827586206896, 'avg_expected_loss': 1.4944781328069752}
=== Cycle 3/7 ===
Resampled validation set with 103 examples
Epoch 1/3, Loss: 13.0738
Epoch 2/3, Loss: 11.4083
Epoch 3/3, Loss: 10.1482
Training metrics: {'losses': [13.073823738098145, 11.408328437805176, 10.148172092437743], 'avg_loss': 11.543441422780356, 'examples_trained': 80, 'examples_revisited': 80}
Cycle 3 metrics: {'rmse': 1.5734446781948852, 'mae': 1.3495145631067962, 'pearson': 0.35245686560219985, 'spearman': 0.3499372766028411, 'kendall': 0.2941553324956298, 'accuracy': 0.11650485436893204, 'avg_expected_loss': 1.4614914736701448}
=== Cycle 4/7 ===
Resampled validation set with 73 examples
Epoch 1/3, Loss: 8.9734
Epoch 2/3, Loss: 8.0321
Epoch 3/3, Loss: 7.3124
Training metrics: {'losses': [8.97342824935913, 8.032072162628173, 7.312422466278076], 'avg_loss': 8.105974292755127, 'examples_trained': 80, 'examples_revisited': 80}
Cycle 4 metrics: {'rmse': 1.6757742025947864, 'mae': 1.3835616438356164, 'pearson': 0.3080732923019505, 'spearman': 0.24681435054159606, 'kendall': 0.1974511655059376, 'accuracy': 0.1917808219178082, 'avg_expected_loss': 1.4283624797651213}
=== Cycle 5/7 ===
Resampled validation set with 49 examples
Epoch 1/3, Loss: 7.2363
Epoch 2/3, Loss: 6.7172
Epoch 3/3, Loss: 6.4620
Training metrics: {'losses': [7.236259031295776, 6.717227458953857, 6.462036609649658], 'avg_loss': 6.805174366633097, 'examples_trained': 80, 'examples_revisited': 80}
Cycle 5 metrics: {'rmse': 1.5971914124998499, 'mae': 1.3673469387755102, 'pearson': 0.5537943292907835, 'spearman': 0.6311244261344301, 'kendall': 0.5447959435885605, 'accuracy': 0.12244897959183673, 'avg_expected_loss': 1.3678529335528005}
=== Cycle 6/7 ===
Resampled validation set with 32 examples
Epoch 1/3, Loss: 5.9985
Epoch 2/3, Loss: 5.6996
Epoch 3/3, Loss: 5.5865
Training metrics: {'losses': [5.998542928695679, 5.699603939056397, 5.586537718772888], 'avg_loss': 5.761561528841654, 'examples_trained': 80, 'examples_revisited': 80}
Cycle 6 metrics: {'rmse': 1.648863244784115, 'mae': 1.34375, 'pearson': 0.1325449905759874, 'spearman': -0.0006742808959742121, 'kendall': -0.009745089103411436, 'accuracy': 0.15625, 'avg_expected_loss': 1.1101701874285936}
=== Cycle 7/7 ===
Resampled validation set with 19 examples
Epoch 1/3, Loss: 5.4244
Epoch 2/3, Loss: 5.3318
Epoch 3/3, Loss: 5.2680
Training metrics: {'losses': [5.424375700950622, 5.331763482093811, 5.267995381355286], 'avg_loss': 5.3413781881332385, 'examples_trained': 80, 'examples_revisited': 80}
Cycle 7 metrics: {'rmse': 1.4867838833500564, 'mae': 1.0526315789473684, 'pearson': 0.3789153285319473, 'spearman': 0.35793247034841336, 'kendall': 0.32566947363946486, 'accuracy': 0.3684210526315789, 'avg_expected_loss': 1.2302408563463312}
Final test metrics: {'rmse': 0.9331845119446279, 'mae': 0.49583333333333335, 'pearson': 0.6953406587526237, 'spearman': 0.6909733694418018, 'kendall': 0.6412696542237327, 'accuracy': 0.6666666666666666, 'avg_expected_loss': 0.645270836011817}

=== Running Gradient-All Experiment ===
Initial validation metrics: {'rmse': 1.002773930432755, 'mae': 0.7444444444444445, 'pearson': 0.6270296428642088, 'spearman': 0.6418109732679096, 'kendall': 0.5621685467007835, 'accuracy': 0.37222222222222223, 'avg_expected_loss': 1.5684840659300485}
=== Cycle 1/7 ===
Computing validation gradients:   0%|          | 0/3 [00:00<?, ?it/s]Computing validation gradients:  33%|███▎      | 1/3 [00:12<00:24, 12.06s/it]Computing validation gradients:  67%|██████▋   | 2/3 [00:24<00:12, 12.06s/it]Computing validation gradients: 100%|██████████| 3/3 [00:36<00:00, 12.07s/it]Computing validation gradients: 100%|██████████| 3/3 [00:36<00:00, 12.07s/it]
Computing gradient alignment:   0%|          | 0/75 [00:00<?, ?it/s]Computing gradient alignment:   1%|▏         | 1/75 [00:00<00:33,  2.19it/s]Computing gradient alignment:   3%|▎         | 2/75 [00:01<00:37,  1.95it/s]Computing gradient alignment:   4%|▍         | 3/75 [00:01<00:41,  1.75it/s]Computing gradient alignment:   5%|▌         | 4/75 [00:02<00:45,  1.57it/s]Computing gradient alignment:   7%|▋         | 5/75 [00:02<00:42,  1.65it/s]Computing gradient alignment:   8%|▊         | 6/75 [00:03<00:38,  1.80it/s]Computing gradient alignment:   9%|▉         | 7/75 [00:04<00:41,  1.63it/s]Computing gradient alignment:  11%|█         | 8/75 [00:04<00:39,  1.68it/s]Computing gradient alignment:  12%|█▏        | 9/75 [00:05<00:40,  1.65it/s]Computing gradient alignment:  13%|█▎        | 10/75 [00:05<00:36,  1.79it/s]Computing gradient alignment:  15%|█▍        | 11/75 [00:06<00:37,  1.71it/s]Computing gradient alignment:  16%|█▌        | 12/75 [00:06<00:36,  1.74it/s]Computing gradient alignment:  17%|█▋        | 13/75 [00:07<00:33,  1.86it/s]Computing gradient alignment:  19%|█▊        | 14/75 [00:07<00:33,  1.85it/s]Computing gradient alignment:  20%|██        | 15/75 [00:08<00:32,  1.84it/s]Computing gradient alignment:  21%|██▏       | 16/75 [00:09<00:32,  1.83it/s]Computing gradient alignment:  23%|██▎       | 17/75 [00:09<00:33,  1.74it/s]Computing gradient alignment:  24%|██▍       | 18/75 [00:10<00:33,  1.68it/s]Computing gradient alignment:  25%|██▌       | 19/75 [00:10<00:34,  1.64it/s]Computing gradient alignment:  27%|██▋       | 20/75 [00:11<00:30,  1.78it/s]Computing gradient alignment:  28%|██▊       | 21/75 [00:12<00:31,  1.70it/s]Computing gradient alignment:  29%|██▉       | 22/75 [00:12<00:31,  1.66it/s]Computing gradient alignment:  31%|███       | 23/75 [00:13<00:31,  1.63it/s]Computing gradient alignment:  32%|███▏      | 24/75 [00:13<00:30,  1.68it/s]Computing gradient alignment:  33%|███▎      | 25/75 [00:14<00:31,  1.57it/s]Computing gradient alignment:  35%|███▍      | 26/75 [00:15<00:28,  1.71it/s]Computing gradient alignment:  36%|███▌      | 27/75 [00:15<00:28,  1.66it/s]Computing gradient alignment:  37%|███▋      | 28/75 [00:16<00:26,  1.78it/s]Computing gradient alignment:  39%|███▊      | 29/75 [00:16<00:25,  1.79it/s]Computing gradient alignment:  40%|████      | 30/75 [00:17<00:23,  1.89it/s]Computing gradient alignment:  41%|████▏     | 31/75 [00:17<00:23,  1.87it/s]Computing gradient alignment:  43%|████▎     | 32/75 [00:18<00:22,  1.95it/s]Computing gradient alignment:  44%|████▍     | 33/75 [00:18<00:21,  1.91it/s]Computing gradient alignment:  45%|████▌     | 34/75 [00:19<00:21,  1.88it/s]Computing gradient alignment:  47%|████▋     | 35/75 [00:19<00:22,  1.78it/s]Computing gradient alignment:  48%|████▊     | 36/75 [00:20<00:20,  1.88it/s]Computing gradient alignment:  49%|████▉     | 37/75 [00:20<00:20,  1.86it/s]Computing gradient alignment:  51%|█████     | 38/75 [00:21<00:22,  1.68it/s]Computing gradient alignment:  52%|█████▏    | 39/75 [00:22<00:21,  1.64it/s]Computing gradient alignment:  53%|█████▎    | 40/75 [00:22<00:19,  1.78it/s]Computing gradient alignment:  55%|█████▍    | 41/75 [00:23<00:18,  1.88it/s]Computing gradient alignment:  56%|█████▌    | 42/75 [00:23<00:17,  1.86it/s]Computing gradient alignment:  57%|█████▋    | 43/75 [00:24<00:15,  2.05it/s]Computing gradient alignment:  59%|█████▊    | 44/75 [00:24<00:14,  2.21it/s]Computing gradient alignment:  60%|██████    | 45/75 [00:25<00:14,  2.07it/s]Computing gradient alignment:  61%|██████▏   | 46/75 [00:25<00:16,  1.80it/s]Computing gradient alignment:  63%|██████▎   | 47/75 [00:26<00:17,  1.64it/s]Computing gradient alignment:  64%|██████▍   | 48/75 [00:26<00:14,  1.86it/s]Computing gradient alignment:  65%|██████▌   | 49/75 [00:27<00:14,  1.75it/s]Computing gradient alignment:  67%|██████▋   | 50/75 [00:28<00:13,  1.87it/s]Computing gradient alignment:  68%|██████▊   | 51/75 [00:28<00:14,  1.68it/s]Computing gradient alignment:  69%|██████▉   | 52/75 [00:29<00:13,  1.72it/s]Computing gradient alignment:  71%|███████   | 53/75 [00:29<00:13,  1.66it/s]Computing gradient alignment:  72%|███████▏  | 54/75 [00:30<00:11,  1.79it/s]Computing gradient alignment:  73%|███████▎  | 55/75 [00:30<00:09,  2.00it/s]Computing gradient alignment:  75%|███████▍  | 56/75 [00:31<00:10,  1.76it/s]Computing gradient alignment:  76%|███████▌  | 57/75 [00:32<00:09,  1.87it/s]Computing gradient alignment:  77%|███████▋  | 58/75 [00:32<00:09,  1.76it/s]Computing gradient alignment:  79%|███████▊  | 59/75 [00:33<00:09,  1.70it/s]Computing gradient alignment:  80%|████████  | 60/75 [00:33<00:08,  1.82it/s]Computing gradient alignment:  81%|████████▏ | 61/75 [00:34<00:07,  1.92it/s]Computing gradient alignment:  83%|████████▎ | 62/75 [00:34<00:06,  1.99it/s]Computing gradient alignment:  84%|████████▍ | 63/75 [00:35<00:06,  1.84it/s]Computing gradient alignment:  85%|████████▌ | 64/75 [00:35<00:06,  1.74it/s]Computing gradient alignment:  87%|████████▋ | 65/75 [00:36<00:05,  1.85it/s]Computing gradient alignment:  88%|████████▊ | 66/75 [00:37<00:05,  1.67it/s]Computing gradient alignment:  89%|████████▉ | 67/75 [00:37<00:04,  1.89it/s]Computing gradient alignment:  91%|█████████ | 68/75 [00:38<00:04,  1.69it/s]Computing gradient alignment:  92%|█████████▏| 69/75 [00:38<00:03,  1.82it/s]Computing gradient alignment:  93%|█████████▎| 70/75 [00:39<00:02,  1.82it/s]Computing gradient alignment:  95%|█████████▍| 71/75 [00:39<00:01,  2.01it/s]Computing gradient alignment:  96%|█████████▌| 72/75 [00:40<00:01,  1.76it/s]Computing gradient alignment:  97%|█████████▋| 73/75 [00:41<00:01,  1.62it/s]Computing gradient alignment:  99%|█████████▊| 74/75 [00:41<00:00,  1.75it/s]Computing gradient alignment: 100%|██████████| 75/75 [00:42<00:00,  1.69it/s]Computing gradient alignment: 100%|██████████| 75/75 [00:42<00:00,  1.78it/s]
Epoch 1/3, Loss: 20.8320
Epoch 2/3, Loss: 18.9557
Epoch 3/3, Loss: 17.7550
Training metrics: {'losses': [20.83202705383301, 18.95567741394043, 17.754954147338868], 'avg_loss': 19.180886205037435, 'examples_trained': 80, 'examples_revisited': 80}
Cycle 1 metrics: {'rmse': 1.0124228365658292, 'mae': 0.7583333333333333, 'pearson': 0.33149472844026795, 'spearman': 0.35388989083780203, 'kendall': 0.32271562590771885, 'accuracy': 0.375, 'avg_expected_loss': 1.4070689270893733}
=== Cycle 2/7 ===
Resampled validation set with 145 examples
Computing validation gradients:   0%|          | 0/3 [00:00<?, ?it/s]Computing validation gradients:  33%|███▎      | 1/3 [00:03<00:07,  3.63s/it]Computing validation gradients:  67%|██████▋   | 2/3 [00:07<00:03,  3.63s/it]Computing validation gradients: 100%|██████████| 3/3 [00:10<00:00,  3.64s/it]Computing validation gradients: 100%|██████████| 3/3 [00:10<00:00,  3.64s/it]
Computing gradient alignment:   0%|          | 0/75 [00:00<?, ?it/s]Computing gradient alignment:   1%|▏         | 1/75 [00:00<00:33,  2.19it/s]Computing gradient alignment:   3%|▎         | 2/75 [00:00<00:33,  2.20it/s]Computing gradient alignment:   4%|▍         | 3/75 [00:01<00:38,  1.85it/s]Computing gradient alignment:   5%|▌         | 4/75 [00:02<00:43,  1.62it/s]Computing gradient alignment:   7%|▋         | 5/75 [00:02<00:39,  1.78it/s]Computing gradient alignment:   8%|▊         | 6/75 [00:03<00:31,  2.16it/s]Computing gradient alignment:   9%|▉         | 7/75 [00:03<00:37,  1.82it/s]Computing gradient alignment:  11%|█         | 8/75 [00:04<00:36,  1.82it/s]Computing gradient alignment:  12%|█▏        | 9/75 [00:04<00:38,  1.73it/s]Computing gradient alignment:  13%|█▎        | 10/75 [00:05<00:35,  1.85it/s]Computing gradient alignment:  15%|█▍        | 11/75 [00:06<00:36,  1.75it/s]Computing gradient alignment:  16%|█▌        | 12/75 [00:06<00:35,  1.77it/s]Computing gradient alignment:  17%|█▋        | 13/75 [00:06<00:29,  2.09it/s]Computing gradient alignment:  19%|█▊        | 14/75 [00:07<00:30,  2.00it/s]Computing gradient alignment:  20%|██        | 15/75 [00:07<00:30,  1.95it/s]Computing gradient alignment:  21%|██▏       | 16/75 [00:08<00:30,  1.91it/s]Computing gradient alignment:  23%|██▎       | 17/75 [00:09<00:30,  1.88it/s]Computing gradient alignment:  24%|██▍       | 18/75 [00:09<00:32,  1.77it/s]Computing gradient alignment:  25%|██▌       | 19/75 [00:10<00:31,  1.78it/s]Computing gradient alignment:  27%|██▋       | 20/75 [00:10<00:29,  1.89it/s]Computing gradient alignment:  28%|██▊       | 21/75 [00:11<00:30,  1.78it/s]Computing gradient alignment:  29%|██▉       | 22/75 [00:11<00:31,  1.70it/s]Computing gradient alignment:  31%|███       | 23/75 [00:12<00:31,  1.65it/s]Computing gradient alignment:  32%|███▏      | 24/75 [00:13<00:28,  1.79it/s]Computing gradient alignment:  33%|███▎      | 25/75 [00:13<00:30,  1.64it/s]Computing gradient alignment:  35%|███▍      | 26/75 [00:14<00:27,  1.77it/s]Computing gradient alignment:  36%|███▌      | 27/75 [00:14<00:28,  1.70it/s]Computing gradient alignment:  37%|███▋      | 28/75 [00:15<00:25,  1.82it/s]Computing gradient alignment:  39%|███▊      | 29/75 [00:15<00:25,  1.82it/s]Computing gradient alignment:  40%|████      | 30/75 [00:16<00:23,  1.92it/s]Computing gradient alignment:  41%|████▏     | 31/75 [00:16<00:22,  1.99it/s]Computing gradient alignment:  43%|████▎     | 32/75 [00:17<00:19,  2.16it/s]Computing gradient alignment:  44%|████▍     | 33/75 [00:17<00:20,  2.05it/s]Computing gradient alignment:  45%|████▌     | 34/75 [00:18<00:20,  1.97it/s]Computing gradient alignment:  47%|████▋     | 35/75 [00:18<00:21,  1.83it/s]Computing gradient alignment:  48%|████▊     | 36/75 [00:19<00:20,  1.92it/s]Computing gradient alignment:  49%|████▉     | 37/75 [00:19<00:20,  1.89it/s]Computing gradient alignment:  51%|█████     | 38/75 [00:20<00:21,  1.70it/s]Computing gradient alignment:  52%|█████▏    | 39/75 [00:21<00:21,  1.65it/s]Computing gradient alignment:  53%|█████▎    | 40/75 [00:21<00:19,  1.78it/s]Computing gradient alignment:  55%|█████▍    | 41/75 [00:22<00:18,  1.89it/s]Computing gradient alignment:  56%|█████▌    | 42/75 [00:22<00:16,  1.97it/s]Computing gradient alignment:  57%|█████▋    | 43/75 [00:23<00:14,  2.15it/s]Computing gradient alignment:  59%|█████▊    | 44/75 [00:23<00:13,  2.29it/s]Computing gradient alignment:  60%|██████    | 45/75 [00:23<00:14,  2.13it/s]Computing gradient alignment:  61%|██████▏   | 46/75 [00:24<00:15,  1.92it/s]Computing gradient alignment:  63%|██████▎   | 47/75 [00:25<00:15,  1.80it/s]Computing gradient alignment:  64%|██████▍   | 48/75 [00:25<00:12,  2.12it/s]Computing gradient alignment:  65%|██████▌   | 49/75 [00:26<00:13,  1.91it/s]Computing gradient alignment:  67%|██████▋   | 50/75 [00:26<00:12,  1.98it/s]Computing gradient alignment:  68%|██████▊   | 51/75 [00:27<00:13,  1.75it/s]Computing gradient alignment:  69%|██████▉   | 52/75 [00:27<00:12,  1.77it/s]Computing gradient alignment:  71%|███████   | 53/75 [00:28<00:12,  1.70it/s]Computing gradient alignment:  72%|███████▏  | 54/75 [00:29<00:11,  1.82it/s]Computing gradient alignment:  73%|███████▎  | 55/75 [00:29<00:09,  2.02it/s]Computing gradient alignment:  75%|███████▍  | 56/75 [00:30<00:10,  1.77it/s]Computing gradient alignment:  76%|███████▌  | 57/75 [00:30<00:09,  1.87it/s]Computing gradient alignment:  77%|███████▋  | 58/75 [00:31<00:09,  1.76it/s]Computing gradient alignment:  79%|███████▊  | 59/75 [00:31<00:09,  1.70it/s]Computing gradient alignment:  80%|████████  | 60/75 [00:32<00:08,  1.82it/s]Computing gradient alignment:  81%|████████▏ | 61/75 [00:32<00:07,  1.91it/s]Computing gradient alignment:  83%|████████▎ | 62/75 [00:33<00:06,  1.99it/s]Computing gradient alignment:  84%|████████▍ | 63/75 [00:33<00:06,  1.83it/s]Computing gradient alignment:  85%|████████▌ | 64/75 [00:34<00:05,  1.93it/s]Computing gradient alignment:  87%|████████▋ | 65/75 [00:34<00:04,  2.00it/s]Computing gradient alignment:  88%|████████▊ | 66/75 [00:35<00:05,  1.76it/s]Computing gradient alignment:  89%|████████▉ | 67/75 [00:35<00:03,  2.08it/s]Computing gradient alignment:  91%|█████████ | 68/75 [00:36<00:03,  1.79it/s]Computing gradient alignment:  92%|█████████▏| 69/75 [00:37<00:03,  1.90it/s]Computing gradient alignment:  93%|█████████▎| 70/75 [00:37<00:02,  1.97it/s]Computing gradient alignment:  95%|█████████▍| 71/75 [00:37<00:01,  2.28it/s]Computing gradient alignment:  96%|█████████▌| 72/75 [00:38<00:01,  1.90it/s]Computing gradient alignment:  97%|█████████▋| 73/75 [00:39<00:01,  1.70it/s]Computing gradient alignment:  99%|█████████▊| 74/75 [00:39<00:00,  1.82it/s]Computing gradient alignment: 100%|██████████| 75/75 [00:40<00:00,  1.73it/s]Computing gradient alignment: 100%|██████████| 75/75 [00:40<00:00,  1.86it/s]
Epoch 1/3, Loss: 17.2845
Epoch 2/3, Loss: 15.3318
Epoch 3/3, Loss: 13.3583
Training metrics: {'losses': [17.284524631500243, 15.33175868988037, 13.358287143707276], 'avg_loss': 15.324856821695965, 'examples_trained': 80, 'examples_revisited': 80}
Cycle 2 metrics: {'rmse': 1.4550743552514231, 'mae': 1.1655172413793105, 'pearson': 0.39277068133322013, 'spearman': 0.4170717369004863, 'kendall': 0.3541116803837667, 'accuracy': 0.2620689655172414, 'avg_expected_loss': 1.3674982354558747}
=== Cycle 3/7 ===
Resampled validation set with 104 examples
Computing validation gradients:   0%|          | 0/3 [00:00<?, ?it/s]Computing validation gradients:  33%|███▎      | 1/3 [00:02<00:05,  2.51s/it]Computing validation gradients:  67%|██████▋   | 2/3 [00:05<00:02,  2.52s/it]Computing validation gradients: 100%|██████████| 3/3 [00:07<00:00,  2.52s/it]Computing validation gradients: 100%|██████████| 3/3 [00:07<00:00,  2.52s/it]
Computing gradient alignment:   0%|          | 0/75 [00:00<?, ?it/s]Computing gradient alignment:   1%|▏         | 1/75 [00:00<00:34,  2.17it/s]Computing gradient alignment:   3%|▎         | 2/75 [00:00<00:33,  2.18it/s]Computing gradient alignment:   4%|▍         | 3/75 [00:01<00:39,  1.84it/s]Computing gradient alignment:   5%|▌         | 4/75 [00:02<00:44,  1.61it/s]Computing gradient alignment:   7%|▋         | 5/75 [00:02<00:39,  1.78it/s]Computing gradient alignment:   8%|▊         | 6/75 [00:03<00:32,  2.15it/s]Computing gradient alignment:   9%|▉         | 7/75 [00:03<00:35,  1.91it/s]Computing gradient alignment:  11%|█         | 8/75 [00:04<00:35,  1.88it/s]Computing gradient alignment:  12%|█▏        | 9/75 [00:04<00:37,  1.77it/s]Computing gradient alignment:  13%|█▎        | 10/75 [00:05<00:34,  1.88it/s]Computing gradient alignment:  15%|█▍        | 11/75 [00:05<00:36,  1.76it/s]Computing gradient alignment:  16%|█▌        | 12/75 [00:06<00:35,  1.78it/s]Computing gradient alignment:  17%|█▋        | 13/75 [00:06<00:29,  2.09it/s]Computing gradient alignment:  19%|█▊        | 14/75 [00:07<00:30,  1.99it/s]Computing gradient alignment:  20%|██        | 15/75 [00:07<00:31,  1.93it/s]Computing gradient alignment:  21%|██▏       | 16/75 [00:08<00:31,  1.88it/s]Computing gradient alignment:  23%|██▎       | 17/75 [00:09<00:31,  1.85it/s]Computing gradient alignment:  24%|██▍       | 18/75 [00:09<00:32,  1.74it/s]Computing gradient alignment:  25%|██▌       | 19/75 [00:10<00:30,  1.86it/s]Computing gradient alignment:  27%|██▋       | 20/75 [00:10<00:26,  2.07it/s]Computing gradient alignment:  28%|██▊       | 21/75 [00:11<00:28,  1.89it/s]Computing gradient alignment:  29%|██▉       | 22/75 [00:11<00:29,  1.77it/s]Computing gradient alignment:  31%|███       | 23/75 [00:12<00:30,  1.69it/s]Computing gradient alignment:  32%|███▏      | 24/75 [00:12<00:28,  1.81it/s]Computing gradient alignment:  33%|███▎      | 25/75 [00:13<00:30,  1.64it/s]Computing gradient alignment:  35%|███▍      | 26/75 [00:14<00:26,  1.86it/s]Computing gradient alignment:  36%|███▌      | 27/75 [00:14<00:27,  1.74it/s]Computing gradient alignment:  37%|███▋      | 28/75 [00:15<00:25,  1.85it/s]Computing gradient alignment:  39%|███▊      | 29/75 [00:15<00:22,  2.05it/s]Computing gradient alignment:  40%|████      | 30/75 [00:15<00:20,  2.22it/s]Computing gradient alignment:  41%|████▏     | 31/75 [00:16<00:18,  2.36it/s]Computing gradient alignment:  43%|████▎     | 32/75 [00:16<00:17,  2.45it/s]Computing gradient alignment:  44%|████▍     | 33/75 [00:17<00:19,  2.21it/s]Computing gradient alignment:  45%|████▌     | 34/75 [00:17<00:19,  2.07it/s]Computing gradient alignment:  47%|████▋     | 35/75 [00:18<00:21,  1.88it/s]Computing gradient alignment:  48%|████▊     | 36/75 [00:18<00:19,  1.96it/s]Computing gradient alignment:  49%|████▉     | 37/75 [00:19<00:19,  1.92it/s]Computing gradient alignment:  51%|█████     | 38/75 [00:20<00:20,  1.80it/s]Computing gradient alignment:  52%|█████▏    | 39/75 [00:20<00:20,  1.72it/s]Computing gradient alignment:  53%|█████▎    | 40/75 [00:21<00:19,  1.84it/s]Computing gradient alignment:  55%|█████▍    | 41/75 [00:21<00:17,  1.93it/s]Computing gradient alignment:  56%|█████▌    | 42/75 [00:22<00:16,  2.01it/s]Computing gradient alignment:  57%|█████▋    | 43/75 [00:22<00:14,  2.18it/s]Computing gradient alignment:  59%|█████▊    | 44/75 [00:22<00:13,  2.32it/s]Computing gradient alignment:  60%|██████    | 45/75 [00:23<00:13,  2.15it/s]Computing gradient alignment:  61%|██████▏   | 46/75 [00:23<00:15,  1.93it/s]Computing gradient alignment:  63%|██████▎   | 47/75 [00:24<00:15,  1.80it/s]Computing gradient alignment:  64%|██████▍   | 48/75 [00:24<00:12,  2.13it/s]Computing gradient alignment:  65%|██████▌   | 49/75 [00:25<00:13,  1.92it/s]Computing gradient alignment:  67%|██████▋   | 50/75 [00:25<00:12,  1.99it/s]Computing gradient alignment:  68%|██████▊   | 51/75 [00:26<00:13,  1.75it/s]Computing gradient alignment:  69%|██████▉   | 52/75 [00:27<00:12,  1.77it/s]Computing gradient alignment:  71%|███████   | 53/75 [00:27<00:12,  1.72it/s]Computing gradient alignment:  72%|███████▏  | 54/75 [00:28<00:10,  1.94it/s]Computing gradient alignment:  73%|███████▎  | 55/75 [00:28<00:09,  2.12it/s]Computing gradient alignment:  75%|███████▍  | 56/75 [00:29<00:10,  1.82it/s]Computing gradient alignment:  76%|███████▌  | 57/75 [00:29<00:08,  2.14it/s]Computing gradient alignment:  77%|███████▋  | 58/75 [00:30<00:08,  1.93it/s]Computing gradient alignment:  79%|███████▊  | 59/75 [00:30<00:08,  1.80it/s]Computing gradient alignment:  80%|████████  | 60/75 [00:31<00:07,  2.01it/s]Computing gradient alignment:  81%|████████▏ | 61/75 [00:31<00:06,  2.06it/s]Computing gradient alignment:  83%|████████▎ | 62/75 [00:32<00:06,  2.10it/s]Computing gradient alignment:  84%|████████▍ | 63/75 [00:32<00:05,  2.13it/s]Computing gradient alignment:  85%|████████▌ | 64/75 [00:33<00:05,  2.15it/s]Computing gradient alignment:  87%|████████▋ | 65/75 [00:33<00:04,  2.17it/s]Computing gradient alignment:  88%|████████▊ | 66/75 [00:34<00:04,  1.85it/s]Computing gradient alignment:  89%|████████▉ | 67/75 [00:34<00:03,  2.17it/s]Computing gradient alignment:  91%|█████████ | 68/75 [00:35<00:03,  1.85it/s]Computing gradient alignment:  92%|█████████▏| 69/75 [00:35<00:03,  1.94it/s]Computing gradient alignment:  93%|█████████▎| 70/75 [00:36<00:02,  2.13it/s]Computing gradient alignment:  95%|█████████▍| 71/75 [00:36<00:01,  2.44it/s]Computing gradient alignment:  96%|█████████▌| 72/75 [00:37<00:01,  1.97it/s]Computing gradient alignment:  97%|█████████▋| 73/75 [00:37<00:01,  1.73it/s]Computing gradient alignment:  99%|█████████▊| 74/75 [00:38<00:00,  1.84it/s]Computing gradient alignment: 100%|██████████| 75/75 [00:38<00:00,  1.74it/s]Computing gradient alignment: 100%|██████████| 75/75 [00:38<00:00,  1.93it/s]
Epoch 1/3, Loss: 11.5187
Epoch 2/3, Loss: 9.9537
Epoch 3/3, Loss: 8.8482
Training metrics: {'losses': [11.518740177154541, 9.953659057617188, 8.848241233825684], 'avg_loss': 10.106880156199137, 'examples_trained': 80, 'examples_revisited': 80}
Cycle 3 metrics: {'rmse': 1.8292495308606331, 'mae': 1.3269230769230769, 'pearson': 0.18368211006205737, 'spearman': 0.0364560891582255, 'kendall': 0.04328514146316875, 'accuracy': 0.375, 'avg_expected_loss': 1.1686099509780223}
=== Cycle 4/7 ===
Resampled validation set with 75 examples
Computing validation gradients:   0%|          | 0/3 [00:00<?, ?it/s]Computing validation gradients:  33%|███▎      | 1/3 [00:01<00:03,  1.96s/it]Computing validation gradients:  67%|██████▋   | 2/3 [00:03<00:01,  1.96s/it]Computing validation gradients: 100%|██████████| 3/3 [00:05<00:00,  1.96s/it]Computing validation gradients: 100%|██████████| 3/3 [00:05<00:00,  1.96s/it]
Computing gradient alignment:   0%|          | 0/75 [00:00<?, ?it/s]Computing gradient alignment:   1%|▏         | 1/75 [00:00<00:33,  2.19it/s]Computing gradient alignment:   3%|▎         | 2/75 [00:00<00:33,  2.19it/s]Computing gradient alignment:   4%|▍         | 3/75 [00:01<00:38,  1.85it/s]Computing gradient alignment:   5%|▌         | 4/75 [00:02<00:43,  1.62it/s]Computing gradient alignment:   7%|▋         | 5/75 [00:02<00:39,  1.79it/s]Computing gradient alignment:   8%|▊         | 6/75 [00:02<00:29,  2.32it/s]Computing gradient alignment:   9%|▉         | 7/75 [00:03<00:33,  2.01it/s]Computing gradient alignment:  11%|█         | 8/75 [00:04<00:34,  1.96it/s]Computing gradient alignment:  12%|█▏        | 9/75 [00:04<00:36,  1.82it/s]Computing gradient alignment:  13%|█▎        | 10/75 [00:05<00:33,  1.92it/s]Computing gradient alignment:  15%|█▍        | 11/75 [00:05<00:36,  1.78it/s]Computing gradient alignment:  16%|█▌        | 12/75 [00:06<00:35,  1.78it/s]Computing gradient alignment:  17%|█▋        | 13/75 [00:06<00:29,  2.10it/s]Computing gradient alignment:  19%|█▊        | 14/75 [00:07<00:30,  1.99it/s]Computing gradient alignment:  20%|██        | 15/75 [00:07<00:31,  1.92it/s]Computing gradient alignment:  21%|██▏       | 16/75 [00:08<00:31,  1.88it/s]Computing gradient alignment:  23%|██▎       | 17/75 [00:08<00:31,  1.85it/s]Computing gradient alignment:  24%|██▍       | 18/75 [00:09<00:31,  1.83it/s]Computing gradient alignment:  25%|██▌       | 19/75 [00:09<00:29,  1.92it/s]Computing gradient alignment:  27%|██▋       | 20/75 [00:10<00:25,  2.12it/s]Computing gradient alignment:  28%|██▊       | 21/75 [00:10<00:28,  1.92it/s]Computing gradient alignment:  29%|██▉       | 22/75 [00:11<00:29,  1.81it/s]Computing gradient alignment:  31%|███       | 23/75 [00:12<00:30,  1.73it/s]Computing gradient alignment:  32%|███▏      | 24/75 [00:12<00:26,  1.93it/s]Computing gradient alignment:  33%|███▎      | 25/75 [00:13<00:29,  1.70it/s]Computing gradient alignment:  35%|███▍      | 26/75 [00:13<00:25,  1.91it/s]Computing gradient alignment:  36%|███▌      | 27/75 [00:14<00:25,  1.87it/s]Computing gradient alignment:  37%|███▋      | 28/75 [00:14<00:24,  1.94it/s]Computing gradient alignment:  39%|███▊      | 29/75 [00:15<00:20,  2.25it/s]Computing gradient alignment:  40%|████      | 30/75 [00:15<00:19,  2.36it/s]Computing gradient alignment:  41%|████▏     | 31/75 [00:15<00:17,  2.45it/s]Computing gradient alignment:  43%|████▎     | 32/75 [00:16<00:17,  2.52it/s]Computing gradient alignment:  44%|████▍     | 33/75 [00:16<00:18,  2.25it/s]Computing gradient alignment:  45%|████▌     | 34/75 [00:17<00:18,  2.23it/s]Computing gradient alignment:  47%|████▋     | 35/75 [00:17<00:20,  1.97it/s]Computing gradient alignment:  48%|████▊     | 36/75 [00:18<00:19,  2.03it/s]Computing gradient alignment:  49%|████▉     | 37/75 [00:18<00:19,  1.97it/s]Computing gradient alignment:  51%|█████     | 38/75 [00:19<00:19,  1.93it/s]Computing gradient alignment:  52%|█████▏    | 39/75 [00:19<00:20,  1.79it/s]Computing gradient alignment:  53%|█████▎    | 40/75 [00:20<00:18,  1.88it/s]Computing gradient alignment:  55%|█████▍    | 41/75 [00:20<00:17,  1.95it/s]Computing gradient alignment:  56%|█████▌    | 42/75 [00:21<00:16,  2.00it/s]Computing gradient alignment:  57%|█████▋    | 43/75 [00:21<00:14,  2.17it/s]Computing gradient alignment:  59%|█████▊    | 44/75 [00:22<00:13,  2.29it/s]Computing gradient alignment:  60%|██████    | 45/75 [00:22<00:13,  2.25it/s]Computing gradient alignment:  61%|██████▏   | 46/75 [00:23<00:14,  1.98it/s]Computing gradient alignment:  63%|██████▎   | 47/75 [00:23<00:15,  1.84it/s]Computing gradient alignment:  64%|██████▍   | 48/75 [00:24<00:12,  2.17it/s]Computing gradient alignment:  65%|██████▌   | 49/75 [00:24<00:12,  2.05it/s]Computing gradient alignment:  67%|██████▋   | 50/75 [00:25<00:11,  2.09it/s]Computing gradient alignment:  68%|██████▊   | 51/75 [00:25<00:13,  1.81it/s]Computing gradient alignment:  69%|██████▉   | 52/75 [00:26<00:12,  1.82it/s]Computing gradient alignment:  71%|███████   | 53/75 [00:27<00:12,  1.73it/s]Computing gradient alignment:  72%|███████▏  | 54/75 [00:27<00:10,  1.93it/s]Computing gradient alignment:  73%|███████▎  | 55/75 [00:27<00:09,  2.11it/s]Computing gradient alignment:  75%|███████▍  | 56/75 [00:28<00:10,  1.80it/s]Computing gradient alignment:  76%|███████▌  | 57/75 [00:28<00:08,  2.11it/s]Computing gradient alignment:  77%|███████▋  | 58/75 [00:29<00:08,  2.00it/s]Computing gradient alignment:  79%|███████▊  | 59/75 [00:30<00:08,  1.83it/s]Computing gradient alignment:  80%|████████  | 60/75 [00:30<00:07,  2.02it/s]Computing gradient alignment:  81%|████████▏ | 61/75 [00:30<00:06,  2.06it/s]Computing gradient alignment:  83%|████████▎ | 62/75 [00:31<00:05,  2.21it/s]Computing gradient alignment:  84%|████████▍ | 63/75 [00:31<00:05,  2.22it/s]Computing gradient alignment:  85%|████████▌ | 64/75 [00:32<00:04,  2.21it/s]Computing gradient alignment:  87%|████████▋ | 65/75 [00:32<00:04,  2.21it/s]Computing gradient alignment:  88%|████████▊ | 66/75 [00:33<00:04,  1.87it/s]Computing gradient alignment:  89%|████████▉ | 67/75 [00:33<00:03,  2.20it/s]Computing gradient alignment:  91%|█████████ | 68/75 [00:34<00:03,  1.87it/s]Computing gradient alignment:  92%|█████████▏| 69/75 [00:34<00:02,  2.07it/s]Computing gradient alignment:  93%|█████████▎| 70/75 [00:35<00:02,  2.24it/s]Computing gradient alignment:  95%|█████████▍| 71/75 [00:35<00:01,  2.54it/s]Computing gradient alignment:  96%|█████████▌| 72/75 [00:35<00:01,  2.14it/s]Computing gradient alignment:  97%|█████████▋| 73/75 [00:36<00:01,  1.82it/s]Computing gradient alignment:  99%|█████████▊| 74/75 [00:37<00:00,  2.01it/s]Computing gradient alignment: 100%|██████████| 75/75 [00:37<00:00,  1.84it/s]Computing gradient alignment: 100%|██████████| 75/75 [00:37<00:00,  1.99it/s]
Epoch 1/3, Loss: 8.3325
Epoch 2/3, Loss: 7.6955
Epoch 3/3, Loss: 7.1026
Training metrics: {'losses': [8.332520294189454, 7.695523452758789, 7.102566337585449], 'avg_loss': 7.710203361511231, 'examples_trained': 80, 'examples_revisited': 80}
Cycle 4 metrics: {'rmse': 1.7009801096230766, 'mae': 1.2933333333333332, 'pearson': 0.35204024559650116, 'spearman': 0.28844444978097933, 'kendall': 0.2660877982448576, 'accuracy': 0.28, 'avg_expected_loss': 1.0144094069798788}
=== Cycle 5/7 ===
Resampled validation set with 54 examples
Computing validation gradients:   0%|          | 0/3 [00:00<?, ?it/s]Computing validation gradients:  33%|███▎      | 1/3 [00:01<00:02,  1.37s/it]Computing validation gradients:  67%|██████▋   | 2/3 [00:02<00:01,  1.39s/it]Computing validation gradients: 100%|██████████| 3/3 [00:04<00:00,  1.41s/it]Computing validation gradients: 100%|██████████| 3/3 [00:04<00:00,  1.40s/it]
Computing gradient alignment:   0%|          | 0/75 [00:00<?, ?it/s]Computing gradient alignment:   1%|▏         | 1/75 [00:00<00:27,  2.68it/s]Computing gradient alignment:   3%|▎         | 2/75 [00:00<00:31,  2.34it/s]Computing gradient alignment:   4%|▍         | 3/75 [00:01<00:38,  1.89it/s]Computing gradient alignment:   5%|▌         | 4/75 [00:02<00:43,  1.63it/s]Computing gradient alignment:   7%|▋         | 5/75 [00:02<00:39,  1.79it/s]Computing gradient alignment:   8%|▊         | 6/75 [00:02<00:29,  2.32it/s]Computing gradient alignment:   9%|▉         | 7/75 [00:03<00:34,  2.00it/s]Computing gradient alignment:  11%|█         | 8/75 [00:04<00:34,  1.94it/s]Computing gradient alignment:  12%|█▏        | 9/75 [00:04<00:36,  1.79it/s]Computing gradient alignment:  13%|█▎        | 10/75 [00:05<00:34,  1.88it/s]Computing gradient alignment:  15%|█▍        | 11/75 [00:05<00:36,  1.76it/s]Computing gradient alignment:  16%|█▌        | 12/75 [00:06<00:35,  1.77it/s]Computing gradient alignment:  17%|█▋        | 13/75 [00:06<00:29,  2.09it/s]Computing gradient alignment:  19%|█▊        | 14/75 [00:07<00:30,  1.99it/s]Computing gradient alignment:  20%|██        | 15/75 [00:07<00:31,  1.92it/s]Computing gradient alignment:  21%|██▏       | 16/75 [00:08<00:30,  1.90it/s]Computing gradient alignment:  23%|██▎       | 17/75 [00:08<00:30,  1.87it/s]Computing gradient alignment:  24%|██▍       | 18/75 [00:09<00:30,  1.86it/s]Computing gradient alignment:  25%|██▌       | 19/75 [00:09<00:28,  1.95it/s]Computing gradient alignment:  27%|██▋       | 20/75 [00:10<00:25,  2.14it/s]Computing gradient alignment:  28%|██▊       | 21/75 [00:10<00:26,  2.04it/s]